---
title: "@/application-shell-connectors"
---

<Subtitle>

Complementary tools for the [`@commercetools-frontend/application-shell`](/api-reference/commercetools-frontend-application-shell).

</Subtitle>

# Installation

```
yarn add @commercetools-frontend/application-shell-connectors

# or

npm --save install @commercetools-frontend/application-shell-connectors
```

Additionally install the peer dependencies (if not present)

```
yarn add react @apollo/client

# or

npm --save install react @apollo/client
```

# Application context

This section describes different parts of information provided through the application context and how it can be accessed.

## Application properties

This is the list of the main properties you can access in the application context.

### `environment`

The information about the runtime application environment such as the [application ID](/api-reference/application-config#envproductionapplicationid) or the [application entry point](/api-reference/application-config#entrypointuripath).

```json
{
  "environment": {
    "applicationId": "ckw3vt1hv034901uzio4bkzc3:my-custom-application",
    "applicationName": "My Custom Application",
    "entryPointUriPath": "my-custom-application"
  }
}
```

### `user`

The information about the logged in user.

```json
{
  "user": {
    "id": "3mj76c04-f910-4223-84e1-f97b0fe291c2",
    "email": "john.doe@domain.com",
    "firstName": "John",
    "lastName": "Doe",
    "businessRole": "Consultant",
    "locale": "en-GB",
    "timeZone": "Europe/Berlin",
    "projects": [
      { "key": "my-project-A", "name": "My Project A" },
      { "key": "my-project-B", "name": "My Project B" }
    ]
  }
}
```


### `project`

The information about the currently selected project.

```json
{
  "project": {
    "countries": ["DE", "US"],
    "currencies": ["EUR", "USD"],
    "key": "project-a",
    "languages": ["de-DE", "en-US"],
    "name": "Project A",
    "ownerId": "3mj76c04-f910-4223-84e1-f97b0fe291c2",
    "ownerName": "My Organization"
  }
}
```

### `dataLocale`

The selected data locale that is used to render localized data in your application.
You should use it as the selected language in components such as [LocalizedTextField](https://uikit.commercetools.com/?path=/story/components-fields--localizedtextfield).

```json
{
  "dataLocale": "de"
}
```

<Info>

This is not the value used for the Merchant Center language, which is based on the `user.locale`.

</Info>

## Custom user properties

On top of the default properties in the `context.environment` object, any property defined in the [`additionalEnv`](/api-reference/application-config#additionalenv) object will be available in the `context.environment` object as well.

This is useful to inject values specific to your application. For example:

```json title="custom-application-config.json" highlightLines="5-7"
{
  "name": "My Custom Application",
  "entryPointUriPath": "my-custom-application",
  "cloudIdentifier": "gcp-eu",
  "additionalEnv": {
    "trackingSentry": "https://000@sentry.io/000",
  }
}
```

The `context.environment` object will then include the `trackingSentry` property:

```json highlightLines="6"
{
  "environment": {
    "applicationId": "ckw3vt1hv034901uzio4bkzc3:my-custom-application",
    "applicationName": "My Custom Application",
    "entryPointUriPath": "my-custom-application",
    "trackingSentry": "https://000@sentry.io/000",
  }
}
```

## Usage

### useApplicationContext

A React hook that allows to access the `ApplicationContext` and selectively pick the necessary properties.

```jsx highlightLines="4-6"
import { useApplicationContext } from '@commercetools-frontend/application-shell-connectors';

const DisplayLocale = () => {
  const dataLocale = useApplicationContext((context) =>
    applicationContext.dataLocale
  );
  render() {
    return (
      <div>
        <h1>Current data locale: {dataLocale}</h1>
      </div>
    );
  }
}

export default DisplayLocale;
```

### withApplicationContext

A higher-order component (HOC) that allows to access the `ApplicationContext` and selectively pick the necessary properties. This is the equivalent of the React hook `useApplicationContext`.

```jsx highlightLines="13-15"
import { withApplicationContext } from '@commercetools-frontend/application-shell-connectors';

class DisplayLocale extends React.Component {
  render() {
    return (
      <div>
        <h1>Current data locale: {this.props.dataLocale}</h1>
      </div>
    );
  }
}

export default withApplicationContext((applicationContext) => ({
  dataLocale: applicationContext.dataLocale
}))(DisplayLocale);
```

# Project image settings

Product images can be uploaded to the commercetools platform or can be referenced from external sources.

By default, images referenced from external sources are not displayed in the Merchant Center. This is primarily due to avoid possible performance issues in case the size of those images is big.

In order to show images referenced from external sources, you need to define a configuration to rewrite the URL of the images to versions of the image that has a smaller size. You can configure that in the Merchant Center **Settings > Project Settings > Miscellaneous**.

This configuration can be fetched from your Custom Application using the following components.

## Usage

### ProjectExtensionProviderForImageRegex

This is the React context provider that loads the image regex configuration and exposes it via a React context so that children can access the configuration.

<Info>

This component is required to be defined in a parent component where children of this component need to access the configuration.

</Info>

#### Properties

| Props                           | Type                       | Required | Values            | Default   | Description                                                              |
| ------------------------------- | -------------------------- | :------: | ----------------- | --------- | -------------------------------------------------------------------------|
| `children`                      | `ReactNode`                |    ✅    | -                 | -         | Components that should be rendered within the scope of this provider.    |
| `skip`                          | `boolean`                  |    -     | -                 | false     | Disables loading images configuration.                                   |


### GetProjectExtensionImageRegex

Use this component to access the project images configuration, using a `render` prop function.

```jsx
function MyComponent() {
  return (
    <GetProjectExtensionImageRegex
      render={({ isLoading, imageRegex }) => {
        if (isLoading) return <LoadingSpinner />;

        return (
          <div>
            <h1>Project images regex: {imageRegex}</h1>
          </div>
        );
      }}
    />
  );
}

function MyApp() {
  return (
    <ProjectExtensionProviderForImageRegex>
      <MyComponent />
    </ProjectExtensionProviderForImageRegex>
  );
}
```

#### Properties

| Props                           | Type                                                 | Required | Values            | Default   | Description                                                               |
| ------------------------------- | ---------------------------------------------------- | :------: | ----------------- | --------- | --------------------------------------------------------------------------|
| `render`                        | `Function`<br/>[See signature.](#signature-render)   |    ✅    | -                 | -         | Function to render children component with the image regex configuration. |

#### Signature `render`

```ts
(
  render: (imageRegexContextData: TImageRegexContext) => ReactNode
) => void
```

This is the shape of the param provided in the render prop:

```ts
type TImageRegexContext = {
  isLoading: boolean;
  imageRegex?: {
    small?: {
      flag: string;
      replace: string;
      search: string;
    } | null;
    thumb?: {
      flag: string;
      replace: string;
      search: string;
    } | null;
  } | null;
}
```


### withProjectExtensionImageRegex

A higher-order component (HOC) to access the image regex configuration.

```jsx
class MyComponent extends React.Component {
  render() {
    const { imageRegexData } = this.props;
    return (
      <div>
        <h2>Project images regex is loading?: {imageRegexData.isLoading}</h2>
        <h2>Project images regex: {imageRegexData.imageRegex}</h2>
      </div>
    );
  }
}

const WrappedComponent = withProjectExtensionImageRegex()(MyComponent);

class MyApp extends React.Component {
  render() {
    return (
      <ProjectExtensionProviderForImageRegex>
        <MyComponent />
      </ProjectExtensionProviderForImageRegex>
    );
  }
}
```

#### Properties

| Props                           | Type                               | Required | Values            | Default                  | Description                                                                                                 |
| ------------------------------- | ---------------------------------- | :------: | ----------------- | ------------------------ | ------------------------------------------------------------------------------------------------------------|
| `propKey`                       | `string`                           |    -     | -                 | `imageRegexData`         | Name of the prop where the image regular expression context data will be provided to the wrapped component. |
