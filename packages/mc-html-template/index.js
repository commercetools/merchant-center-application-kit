module.exports = templateParams => {
  const cssVendorChunks = [];
  const cssAppChunks = [];

  templateParams.htmlWebpackPlugin.files.css.forEach(file => {
    if (file.indexOf('vendor') === -1) {
      cssAppChunks.push(file);
    } else {
      cssVendorChunks.push(file);
    }
  });

  const cssChunks = cssVendorChunks.concat(cssAppChunks).map(fileName => {
    const chunkPath = fileName.replace(/^\//, '');
    return `<link href="__CDN_URL__${chunkPath}" rel='stylesheet' type='text/css'></link>`;
  });
  const scriptChunks = templateParams.htmlWebpackPlugin.files.js.map(
    fileName => {
      // Trim leading slash, the CDN_URL will ensure to have a trailing slash
      // (see `replaceHtmlPlaceholders`)
      const chunkPath = fileName.replace(/^\//, '');
      return `<script src="__CDN_URL__${chunkPath}"></script>`;
    }
  );

  return `
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="preconnect" href="__CDN_URL__">
    <link rel="preconnect" href="__MC_API_URL__">
    <!-- Fav and touch icons -->
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <!-- Standard iPhone -->
    <link rel="apple-touch-icon" sizes="57x57" href="/favicon_57x57px.png">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/favicon_57x57px.png">
    <!-- Retina iPhone  - COMMENTED OUT AS ICON FILES DO NOT EXIST -->
    <!-- <link rel="apple-touch-icon" sizes="114x114" href="/favicon_114x114px.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114Ã—114" href="/favicon_114x114px.png" />-->
    <!-- Standard iPad -->
    <link rel="apple-touch-icon" sizes="72x72" href="/favicon_72x72px.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/favicon_72x72px.png">
    <!-- Retina iPad -->
    <link rel="apple-touch-icon" sizes="144x144" href="/favicon_144x144px.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon_144x144px.png">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i' rel='stylesheet' type='text/css'></link>
    ${cssChunks.join('\n')}
    <title>Merchant Center</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="app-loader">
      <!-- Loading screen styles -->
      <style>__LOADING_SCREEN_CSS__</style>

      <div class="loading-screen loading-screen--hidden">
        <svg class="loading-spinner" viewBox="0 0 40 40">
          <path class="loading-spinner-circle" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946, 14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"></path>
          <path class="loading-spinner-pointer" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z"></path>
        </svg>
        <img
          class="logo"
          src="data:image/svg+xml,%3C?xml version='1.0' encoding='UTF-8' standalone='no'?%3E %3Csvg width='200px' height='29px' viewBox='0 0 200 29' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E %3C!-- Generator: Sketch 44.1 (41455) - http://www.bohemiancoding.com/sketch --%3E %3Ctitle%3EGroup 2%3C/title%3E %3Cdesc%3ECreated with Sketch.%3C/desc%3E %3Cdefs%3E%3C/defs%3E %3Cg id='Final' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E %3Cg id='Indeterminate---Loading-page-Copy-2' transform='translate(-470.000000, -436.000000)'%3E %3Cg id='Group' transform='translate(470.000000, 415.000000)'%3E %3Cg id='CT-logo-horizontal-RGB-(1)'%3E %3Cg id='Group-2' transform='translate(0.000000, 21.000000)'%3E %3Cpath d='M38.3424775,20.486094 C39.443664,20.486094 40.0798766,20.4125297 41.4747508,20.118842 L41.8178453,22.4683436 C40.7408163,22.7615093 39.5419079,22.9086379 38.3424775,22.9086379 C32.983626,22.9086379 31.4419079,19.5561936 31.4419079,15.6408163 C31.4907451,11.8234457 33.7911248,8.59340294 38.3183199,8.59340294 C39.5172283,8.59340294 40.5448505,8.74000949 41.7931656,9.05837684 L41.3281917,11.3831514 C40.0068818,11.0894637 39.2235406,11.0406265 38.3918842,11.0406265 C35.5532511,11.0894637 34.1583768,13.1935928 34.1089701,15.6408163 C34.1089701,18.0630755 35.0147129,20.486094 38.3424775,20.486094' id='Fill-1' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M49.3037494,20.5102515 C52.1181775,20.486094 53.0237304,18.2101566 53.0237304,15.7390603 C52.9995254,13.4872805 52.0446132,10.9423825 49.2795444,10.9423825 C46.5877076,10.9670622 45.5353583,13.4631229 45.5353583,15.7390603 C45.5353583,18.3078785 46.661272,20.5102515 49.3037494,20.5102515 Z M49.3037494,8.59340294 C53.7085904,8.61756051 55.6668249,11.8969625 55.6668249,15.7390603 C55.6668249,19.4826293 53.978168,22.8350736 49.2795444,22.8597532 C44.6790223,22.810916 42.9168961,19.4826293 42.9168961,15.7390603 C42.9168961,11.8969625 44.8991457,8.64228761 49.3037494,8.59340294 L49.3037494,8.59340294 Z' id='Fill-3' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M73.8955861,22.6149502 L73.8955861,13.8056953 C73.8955861,11.5785952 73.0640721,10.9670622 71.6691979,10.9670622 C70.7147603,10.9670622 69.6378738,11.5056004 68.6592311,12.3130992 C68.7081158,12.6067869 68.7323208,13.1935928 68.7323208,13.364879 L68.7323208,22.6149502 L65.991457,22.6149502 L65.991457,13.7079734 C65.991457,11.4808733 65.3308021,10.9423825 63.9359279,10.9423825 C63.0550546,10.9423825 61.831514,11.5297579 60.7793071,12.3130992 L60.7793071,22.6149502 L58.0631229,22.6149502 L58.0631229,8.83825344 L60.7793071,8.83825344 L60.7793071,10.0124347 C61.6112957,9.35206455 62.9326056,8.59340294 64.3763645,8.5687233 C66.2852397,8.54456573 67.3863313,9.20493593 67.9985762,10.2325581 C69.1238728,9.18077836 70.7883246,8.59340294 72.0607499,8.5687233 C76.5386806,8.49515899 76.6117703,12.0924063 76.6117703,13.6097295 L76.6117703,22.6149502 L73.8955861,22.6149502' id='Fill-4' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M95.4271476,22.6149502 L95.4271476,13.8056953 C95.4271476,11.5785952 94.5956336,10.9670622 93.2007594,10.9670622 C92.2458472,10.9670622 91.1694352,11.5056004 90.1907926,12.3130992 C90.2396773,12.6067869 90.2638823,13.1935928 90.2638823,13.364879 L90.2638823,22.6149502 L87.5234931,22.6149502 L87.5234931,13.7079734 C87.5234931,11.4808733 86.8623636,10.9423825 85.4674893,10.9423825 C84.586616,10.9423825 83.3630755,11.5297579 82.3103939,12.3130992 L82.3103939,22.6149502 L79.5942098,22.6149502 L79.5942098,8.83825344 L82.3103939,8.83825344 L82.3103939,10.0124347 C83.1428571,9.35206455 84.4641671,8.59340294 85.907926,8.5687233 C87.8163265,8.54456573 88.9178927,9.20493593 89.529663,10.2325581 C90.6559089,9.18077836 92.3194115,8.59340294 93.5918367,8.5687233 C98.0702421,8.49515899 98.1433318,12.0924063 98.1433318,13.6097295 L98.1433318,22.6149502 L95.4271476,22.6149502' id='Fill-5' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M103.035121,14.1235406 L109.07926,14.1235406 C108.98149,11.3337921 107.587091,10.7710963 106.289986,10.7710963 C104.234457,10.7469388 103.280019,12.141813 103.035121,14.1235406 Z M110.816801,20.0941623 L111.233033,22.3212625 C110.009018,22.7373517 108.320835,22.9333175 106.999525,22.9333175 C101.567157,22.9333175 100.245373,19.2866635 100.245373,15.6408163 C100.245373,11.9946844 101.86094,8.61756051 106.412435,8.61756051 C109.226388,8.61756051 111.575225,10.3550071 111.599905,14.7844328 L111.575225,16.2281917 L102.912672,16.2281917 C102.962031,18.9199336 104.40579,20.5591362 107.121974,20.5591362 C108.198386,20.5591362 109.324158,20.4372568 110.816801,20.0941623 L110.816801,20.0941623 Z' id='Fill-6' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M121.582345,11.3584718 C120.87233,11.1871856 120.26056,11.1625059 119.820123,11.1625059 C118.131467,11.1383484 117.250593,11.9705268 116.614143,12.6309445 L116.614143,22.6149502 L113.897959,22.6149502 L113.897959,8.83825344 L116.614143,8.83825344 L116.614143,10.0613194 C117.324158,9.32733745 118.401044,8.69112482 119.795918,8.66644518 C120.358804,8.64228761 121.288562,8.74000949 122.071191,9.0336972 L121.582345,11.3584718' id='Fill-7' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M129.532985,20.486094 C130.634551,20.486094 131.270527,20.4125297 132.665401,20.118842 L133.008543,22.4683436 C131.931656,22.7615093 130.732795,22.9086379 129.532985,22.9086379 C124.174181,22.9086379 122.632178,19.5561936 122.632178,15.6408163 C122.681538,11.8234457 124.981965,8.59340294 129.509255,8.59340294 C130.708116,8.59340294 131.735643,8.74000949 132.983863,9.05837684 L132.518747,11.3831514 C131.197437,11.0894637 130.414333,11.0406265 129.582819,11.0406265 C126.744186,11.0894637 125.349312,13.1935928 125.299478,15.6408163 C125.299478,18.0630755 126.205505,20.486094 129.532985,20.486094' id='Fill-8' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M136.897959,14.1235406 L142.942572,14.1235406 C142.844803,11.3337921 141.449929,10.7710963 140.152824,10.7710963 C138.097295,10.7469388 137.142857,12.141813 136.897959,14.1235406 Z M144.679639,20.0941623 L145.095871,22.3212625 C143.87233,22.7373517 142.183673,22.9333175 140.862364,22.9333175 C135.429995,22.9333175 134.108211,19.2866635 134.108211,15.6408163 C134.108211,11.9946844 135.723778,8.61756051 140.274798,8.61756051 C143.089701,8.61756051 145.438538,10.3550071 145.463218,14.7844328 L145.438538,16.2281917 L136.77551,16.2281917 C136.824869,18.9199336 138.268628,20.5591362 140.984813,20.5591362 C142.061224,20.5591362 143.186996,20.4372568 144.679639,20.0941623 L144.679639,20.0941623 Z' id='Fill-9' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M154.662079,11.0894637 L150.917893,11.0894637 L150.917893,17.7699098 C150.917893,19.164262 151.089226,20.1435691 152.508306,20.3390128 C153.291884,20.4125297 154.099193,20.3390128 154.881822,20.2412909 L155.053156,22.5902231 C154.245847,22.7373517 153.095871,22.7615093 152.630755,22.7615093 C149.424775,22.6396298 148.225914,20.9999051 148.225914,18.43028 L148.225914,11.0894637 L146.243949,11.0894637 L146.243949,9.20493593 L148.225914,8.98481253 L148.225914,5.77897485 L150.917893,5.77897485 L150.917893,8.83825344 L154.662079,8.83825344 L154.662079,11.0894637' id='Fill-10' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M162.565259,20.5102515 C165.379687,20.486094 166.284765,18.2101566 166.284765,15.7390603 C166.26056,13.4872805 165.306122,10.9423825 162.541054,10.9423825 C159.849075,10.9670622 158.796393,13.4631229 158.796393,15.7390603 C158.796393,18.3078785 159.922639,20.5102515 162.565259,20.5102515 Z M162.565259,8.59340294 C166.9701,8.61756051 168.92786,11.8969625 168.92786,15.7390603 C168.92786,19.4826293 167.239203,22.8350736 162.541054,22.8597532 C157.940199,22.810916 156.177978,19.4826293 156.177978,15.7390603 C156.177978,11.8969625 158.160418,8.64228761 162.565259,8.59340294 L162.565259,8.59340294 Z' id='Fill-11' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M177.196963,20.5102515 C180.011391,20.486094 180.916469,18.2101566 180.916469,15.7390603 C180.892264,13.4872805 179.937826,10.9423825 177.172757,10.9423825 C174.480778,10.9670622 173.428097,13.4631229 173.428097,15.7390603 C173.428097,18.3078785 174.554343,20.5102515 177.196963,20.5102515 Z M177.196963,8.59340294 C181.601804,8.61756051 183.559563,11.8969625 183.559563,15.7390603 C183.559563,19.4826293 181.870907,22.8350736 177.172757,22.8597532 C172.571903,22.810916 170.809682,19.4826293 170.809682,15.7390603 C170.809682,11.8969625 172.792121,8.64228761 177.196963,8.59340294 L177.196963,8.59340294 Z' id='Fill-12' fill='%2327373C'%3E%3C/path%3E %3Cpolygon id='Fill-13' fill='%2327373C' points='185.710489 22.6149502 188.328904 22.6149502 188.328904 3.91912672 185.710489 3.91912672'%3E%3C/polygon%3E %3Cpath d='M191.093972,19.9476032 C192.635501,20.3390128 194.07926,20.5349786 194.984813,20.5349786 C196.061699,20.5349786 197.162791,20.3148552 197.236355,19.0176554 C197.309919,17.6475083 195.890365,17.2313716 194.275273,16.5463218 C192.439962,15.7879449 190.457997,14.7597532 190.506882,12.2148078 C190.555766,10.9423825 191.314191,8.44632178 195.376364,8.5687233 C196.599905,8.59340294 198.068344,8.7888467 199.291362,9.10721405 L198.827243,11.3584718 C197.383009,11.0159468 196.306122,10.8688182 195.253916,10.8446607 C194.07926,10.8446607 193.174181,11.2119127 193.125297,12.3130992 C193.100617,13.2429995 193.834836,13.732131 195.645467,14.4660655 C197.481253,15.2247271 200.074988,16.2040342 199.952539,19.0912197 C199.878975,20.9263882 198.680066,22.9333175 194.984813,22.8839108 C193.810157,22.8597532 191.925961,22.7126246 190.531561,22.2235406 L191.093972,19.9476032' id='Fill-14' fill='%2327373C'%3E%3C/path%3E %3Cpath d='M0.348932131,22.3122449 C0.136592311,22.4106312 0.000711912672,22.623683 0.000711912672,22.8572852 C1.08420217e-19,23.091552 0.135215947,23.3038918 0.346843854,23.40299 L12.0100617,28.8637874 C12.1664452,28.9373517 12.3349312,28.9748458 12.5033697,28.9762696 L12.5033697,16.7871381 C12.3299478,16.7871381 12.1565733,16.8239203 11.995159,16.8989559 L0.348932131,22.3122449' id='Fill-15' fill='%23E3712C'%3E%3C/path%3E %3Cpath d='M12.5033697,16.7871381 L12.5033697,28.9762696 C12.6838633,28.9795918 12.8643569,28.9416232 13.0314191,28.8637874 L24.660655,23.419981 C24.8722829,23.3208828 25.0074514,23.108543 25.0067869,22.8742762 C25.0067869,22.6406739 24.871571,22.4283341 24.6592311,22.3292359 L13.0108685,16.8996678 C12.8502136,16.8246322 12.6767916,16.7871381 12.5033697,16.7871381' id='Fill-16' fill='%23EBA13B'%3E%3C/path%3E %3Cpath d='M0.000711912672,6.36288562 C-0.000379686758,6.60056953 0.135215947,6.80953963 0.346843854,6.90859041 L12.0100617,12.3693403 C12.1664452,12.4429521 12.3349312,12.4804461 12.5033697,12.4825819 C12.6513052,12.4847176 12.7992406,12.459943 12.9401044,12.4075463 C13.051495,12.355719 13.0311818,12.3651163 13.2668723,12.2556716 C14.4704319,11.6966777 13.6730422,12.0686284 24.660655,6.9255814 C24.8722829,6.82653061 25.0074514,6.61414333 25.0067869,6.3798766 C25.0067869,6.14632178 24.871571,5.93398196 24.6592311,5.83488372 L13.0108685,0.405315615 C12.6888467,0.255244423 12.3172283,0.255244423 11.995159,0.404603702 L0.348932131,5.81789274 C0.136592311,5.91627907 0.00175605126,6.1293308 0.000711912672,6.36288562' id='Fill-17' fill='%2323A486'%3E%3C/path%3E %3Cpath d='M12.5033697,13.1677266 L12.5033697,16.7871381 C12.3299478,16.7871381 12.1565733,16.8239203 11.995159,16.8989559 L0.348932131,22.3122449 C0.136592311,22.4106312 0.000711912672,22.623683 0.000711912672,22.8572852 L0,6.76986236 C0,6.76986236 0,6.30602753 0,6.36288562 C0,6.59719981 0.134456573,6.80996678 0.34608448,6.90906502 L12.0100617,12.3693403 C12.1664452,12.4429521 12.3349312,12.4804461 12.5033697,12.4825819 C12.6513052,12.4847176 12.7992406,12.459943 12.9401044,12.4075463 L12.9202658,12.4167062 C12.5579972,12.5841481 12.5033697,12.7512103 12.5033697,13.1677266' id='Fill-18' fill='%23CCCCC7'%3E%3C/path%3E %3C/g%3E %3C/g%3E %3C/g%3E %3C/g%3E %3C/g%3E %3C/svg%3E"
        />
        <p class="long-loading-notice long-loading-notice--hidden">Sorry, this is taking an unusually long time.</p>
      </div>
    </div>
    <div id="app"></div>

    <!-- Loading screen handling -->
    <script>__LOADING_SCREEN_JS__</script>

    <!-- Application globals -->
    <script>window.app = __APP_ENVIRONMENT__;</script>

    <!-- Tracking scripts (load before application bundles) -->
    <script>__DATALAYER_JS__</script>
    __GTM_SCRIPT__

    <!-- Main application chunks -->
    ${scriptChunks.join('\n')}

    <!-- NOTE: application chunks will be injected by webpack on runtime -->
  </body>
</html>
  `;
};
